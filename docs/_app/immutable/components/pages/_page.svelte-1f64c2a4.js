import{S as ct,i as it,s as ht,k as d,q as P,a as B,l as _,m as u,r as y,h as i,c as N,n as b,b as X,G as e,I as M,B as at,J as ft,K as dt,u as Q}from"../../chunks/index-b754b1aa.js";function nt(r,s,h){const o=r.slice();return o[13]=s[h],o}function rt(r){let s,h;return{c(){s=d("span"),h=P("*"),this.h()},l(o){s=_(o,"SPAN",{class:!0});var E=u(s);h=y(E,"*"),E.forEach(i),this.h()},h(){b(s,"class","inco-note svelte-rrqzqi")},m(o,E){X(o,s,E),e(s,h)},d(o){o&&i(s)}}}function ot(r){let s,h,o=r[13].rank+"",E,D,T,a=r[13].points+"",H,K,S,C=r[13].name+"",j,L,m,R=r[13].flags.length+"",t,n=r[1](r[13]),F,z,v=r[13].hintCount+"",A,w,k,V=r[3](r[13])+"",Y,G,g=n&&rt();return{c(){s=d("tr"),h=d("th"),E=P(o),D=B(),T=d("td"),H=P(a),K=B(),S=d("td"),j=P(C),L=B(),m=d("td"),t=P(R),g&&g.c(),F=B(),z=d("td"),A=P(v),w=B(),k=d("td"),Y=P(V),G=B(),this.h()},l(p){s=_(p,"TR",{});var l=u(s);h=_(l,"TH",{class:!0});var q=u(h);E=y(q,o),q.forEach(i),D=N(l),T=_(l,"TD",{class:!0});var f=u(T);H=y(f,a),f.forEach(i),K=N(l),S=_(l,"TD",{class:!0});var I=u(S);j=y(I,C),I.forEach(i),L=N(l),m=_(l,"TD",{class:!0});var c=u(m);t=y(c,R),g&&g.l(c),c.forEach(i),F=N(l),z=_(l,"TD",{class:!0});var J=u(z);A=y(J,v),J.forEach(i),w=N(l),k=_(l,"TD",{class:!0});var U=u(k);Y=y(U,V),U.forEach(i),G=N(l),l.forEach(i),this.h()},h(){b(h,"class","svelte-rrqzqi"),b(T,"class","svelte-rrqzqi"),b(S,"class","svelte-rrqzqi"),b(m,"class","svelte-rrqzqi"),b(z,"class","svelte-rrqzqi"),b(k,"class","svelte-rrqzqi")},m(p,l){X(p,s,l),e(s,h),e(h,E),e(s,D),e(s,T),e(T,H),e(s,K),e(s,S),e(S,j),e(s,L),e(s,m),e(m,t),g&&g.m(m,null),e(s,F),e(s,z),e(z,A),e(s,w),e(s,k),e(k,Y),e(s,G)},p(p,l){l&1&&o!==(o=p[13].rank+"")&&Q(E,o),l&1&&a!==(a=p[13].points+"")&&Q(H,a),l&1&&C!==(C=p[13].name+"")&&Q(j,C),l&1&&R!==(R=p[13].flags.length+"")&&Q(t,R),l&1&&(n=p[1](p[13])),n?g||(g=rt(),g.c(),g.m(m,null)):g&&(g.d(1),g=null),l&1&&v!==(v=p[13].hintCount+"")&&Q(A,v),l&1&&V!==(V=p[3](p[13])+"")&&Q(Y,V)},d(p){p&&i(s),g&&g.d()}}}function _t(r){let s,h,o,E,D,T,a,H,K,S,C,j,L,m,R,t,n,F,z,v,A,w,k,V,Y,G,g,p,l=r[0],q=[];for(let f=0;f<l.length;f+=1)q[f]=ot(nt(r,l,f));return{c(){s=d("div"),h=d("h1"),o=P("Ethack scoreboard"),E=B(),D=d("table"),T=d("thead"),a=d("tr"),H=d("th"),K=P("Position"),S=B(),C=d("th"),j=P("Total Points"),L=B(),m=d("th"),R=P("Name"),t=B(),n=d("th"),F=P("Flags captured"),z=B(),v=d("th"),A=P("Hints requested"),w=B(),k=d("th"),V=P("Total requested hint points"),Y=B(),G=d("tbody");for(let f=0;f<q.length;f+=1)q[f].c();this.h()},l(f){s=_(f,"DIV",{class:!0});var I=u(s);h=_(I,"H1",{class:!0});var c=u(h);o=y(c,"Ethack scoreboard"),c.forEach(i),E=N(I),D=_(I,"TABLE",{class:!0});var J=u(D);T=_(J,"THEAD",{});var U=u(T);a=_(U,"TR",{});var O=u(a);H=_(O,"TH",{class:!0});var Z=u(H);K=y(Z,"Position"),Z.forEach(i),S=N(O),C=_(O,"TH",{class:!0});var $=u(C);j=y($,"Total Points"),$.forEach(i),L=N(O),m=_(O,"TH",{class:!0});var x=u(m);R=y(x,"Name"),x.forEach(i),t=N(O),n=_(O,"TH",{class:!0});var tt=u(n);F=y(tt,"Flags captured"),tt.forEach(i),z=N(O),v=_(O,"TH",{class:!0});var et=u(v);A=y(et,"Hints requested"),et.forEach(i),w=N(O),k=_(O,"TH",{class:!0});var st=u(k);V=y(st,"Total requested hint points"),st.forEach(i),O.forEach(i),U.forEach(i),Y=N(J),G=_(J,"TBODY",{});var lt=u(G);for(let W=0;W<q.length;W+=1)q[W].l(lt);lt.forEach(i),J.forEach(i),I.forEach(i),this.h()},h(){b(h,"class","title"),b(H,"class","svelte-rrqzqi"),b(C,"class","svelte-rrqzqi"),b(m,"class","svelte-rrqzqi"),b(n,"class","svelte-rrqzqi"),b(v,"class","svelte-rrqzqi"),b(k,"class","svelte-rrqzqi"),b(D,"class","svelte-rrqzqi"),b(s,"class","main")},m(f,I){X(f,s,I),e(s,h),e(h,o),e(s,E),e(s,D),e(D,T),e(T,a),e(a,H),e(H,K),e(a,S),e(a,C),e(C,j),e(a,L),e(a,m),e(m,R),e(a,t),e(a,n),e(n,F),e(a,z),e(a,v),e(v,A),e(a,w),e(a,k),e(k,V),e(D,Y),e(D,G);for(let c=0;c<q.length;c+=1)q[c].m(G,null);g||(p=[M(H,"click",r[5]),M(C,"click",r[6]),M(m,"click",r[7]),M(n,"click",r[8]),M(v,"click",r[9]),M(k,"click",r[10])],g=!0)},p(f,[I]){if(I&11){l=f[0];let c;for(c=0;c<l.length;c+=1){const J=nt(f,l,c);q[c]?q[c].p(J,I):(q[c]=ot(J),q[c].c(),q[c].m(G,null))}for(;c<q.length;c+=1)q[c].d(1);q.length=l.length}},i:at,o:at,d(f){f&&i(s),ft(q,f),g=!1,dt(p)}}}function ut(r,s,h){let{data:o}=s;const E=t=>t.points+t.flags.length/100-t.hintCount/1e4,D=t=>t.flags.length==15||t.flags.length==16;let T=Object.values(o.players).filter(t=>t.flags.length>0).map(t=>{let n=0,F=0;for(const z of t.flags){let v=10;if(t.hints[z]!==void 0)for(const A of t.hints[z])v-=o.hp[z][A],F+=1;v>0&&(n+=v)}return{...t,points:n,hintCount:F}}).sort((t,n)=>E(n)-E(t)+t.name.localeCompare(n.name)/1e5).map((t,n)=>({rank:n+1,...t}));const a=t=>{const n=K[t];if(!n)return;n.sorted*=-1;const F=(z,v)=>{const A=n.fn(z),w=n.fn(v),k=A>w?1:A<w?-1:0;return n.sorted===-1?-k:k};h(0,T=T.sort(F))},H=t=>t.flags.length*10-t.points,K={points:{sorted:1,fn:t=>t.points},rank:{sorted:1,fn:t=>t.rank},name:{sorted:-1,fn:t=>t.name},flags:{sorted:1,fn:t=>t.flags.length},hintCount:{sorted:1,fn:t=>t.hintCount},hitpoins:{sorted:1,fn:H}},S=()=>a("rank"),C=()=>a("points"),j=()=>a("name"),L=()=>a("flags"),m=()=>a("hintCount"),R=()=>a("hitpoins");return r.$$set=t=>{"data"in t&&h(4,o=t.data)},[T,D,a,H,o,S,C,j,L,m,R]}class gt extends ct{constructor(s){super(),it(this,s,ut,_t,ht,{data:4})}}export{gt as default};
